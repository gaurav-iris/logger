Jaml=function(){return{templates:{},register:function(e,t){this.templates[e]=t},render:function(e,t,n){var r=this.templates[e],i=new Jaml.Template(r);return i.render.apply(i,Array.prototype.slice.call(arguments,1))}}}();Jaml.Node=function(e){this.tagName=e;this.attributes={};this.children=[]};Jaml.Node.prototype={setAttributes:function(e){for(var t in e){var n=t=="cls"?"class":t;this.attributes[n]=e[t]}return this},addChild:function(e){this.children.push(e);return this},render:function(e){e=e||0;var t=[],n=[],r=this instanceof Jaml.TextNode,i=this.multiLineTag();if(!r)t.push(this.getPadding(e));t.push("<"+this.tagName);for(var s in this.attributes){n.push(s+'="'+this.attributes[s]+'"')}n.sort();for(var o=0;o<n.length;o++){t.push(" "+n[o])}if(this.isSelfClosing()&&this.children.length==0){t.push("/>\n")}else{t.push(">");if(i)t.push("\n");this.renderChildren(t,this.children,e);if(i)t.push(this.getPadding(e));t.push("</",this.tagName,">\n")}return t.join("")},renderChildren:function(e,t,n){var r=n+2;for(var i=0;i<t.length;i++){var s=t[i];if(s instanceof Array){var o=s;this.renderChildren(e,o,n)}else{e.push(s.render(r))}}},multiLineTag:function(){var e=this.children.length,t=e>0;if(e==1&&this.children[0]instanceof Jaml.TextNode)t=false;return t},getPadding:function(e){return(new Array(e+1)).join(" ")},isSelfClosing:function(){for(var e=this.notSelfClosingTags.length-1;e>=0;e--){if(this.tagName==this.notSelfClosingTags[e])return false}return true},notSelfClosingTags:["textarea","script","em","strong","option","select"]};Jaml.TextNode=function(e){this.text=e};Jaml.TextNode.prototype={render:function(){return this.text}};Jaml.Template=function(e){this.tpl=e;this.nodes=[]};Jaml.Template.prototype={render:function(thisObj,data){data=data||(thisObj=thisObj||{});if(data.constructor.toString().indexOf("Array")==-1){data=[data]}with(this){for(var i=0;i<data.length;i++){eval("("+this.tpl.toString()+").call(thisObj, data[i], i)")}}var roots=this.getRoots(),output="";for(var i=0;i<roots.length;i++){output+=roots[i].render()}return output},getRoots:function(){var e=[];for(var t=0;t<this.nodes.length;t++){var n=this.nodes[t];if(n.parent==undefined)e.push(n)}return e},tags:["html","head","body","script","meta","title","link","div","p","span","a","img","br","hr","em","strong","table","tr","th","td","thead","tbody","tfoot","ul","ol","li","dl","dt","dd","h1","h2","h3","h4","h5","h6","h7","form","fieldset","input","textarea","label","select","option"]};(function(){var e=Jaml.Template.prototype.tags;var t=function(e){return function(t){var n=new Jaml.Node(e);var r=typeof t=="object"&&!(t instanceof Jaml.Node)&&!(t instanceof Jaml.TextNode);if(r)n.setAttributes(t);var i=r?1:0;for(var s=i;s<arguments.length;s++){var o=arguments[s];if(typeof o=="string"||o==undefined){o=new Jaml.TextNode(o||"")}if(o instanceof Jaml.Node||o instanceof Jaml.TextNode){o.parent=n}n.addChild(o)}this.nodes.push(n);return n}};for(var n=0,r;r=e[n];n++){Jaml.Template.prototype[r]=t(r)}})()